{% extends "home/base.html" %}
{% load static %}
{% block content %}
<!-- ============================ Page Title Start================================== -->
<div class="page-title">
	<div class="container">
		<div class="row">
			<div class="col-lg-12 col-md-12">

				<h2 class="ipt-title">Welcome!</h2>
				<span class="ipn-subtitle">Welcome To Your Account</span>

			</div>
		</div>
	</div>
</div>
<!-- ============================ Page Title End ================================== -->

<!-- ============================ User Dashboard ================================== -->
<section class="bg-light">
	<div class="container-fluid">
		<div class="row">
			<div class="col-lg-12 col-md-12">
				<div class="filter_search_opt">
					<a href="javascript:void(0);" onclick="openFilterSearch()">Dashboard Navigation<i
							class="ml-2 ti-menu"></i></a>
				</div>
			</div>
		</div>

		<div class="row">

			<div class="col-lg-3 col-md-12">

				<div class="simple-sidebar sm-sidebar" id="filter_search">

					<div class="search-sidebar_header">
						<h4 class="ssh_heading">Close Filter</h4>
						<button onclick="closeFilterSearch()" class="w3-bar-item w3-button w3-large"><i
								class="ti-close"></i></button>
					</div>

					<div class="sidebar-widgets">
						<div class="dashboard-navbar">

							<div class="d-user-avater">
								<img src="{% static 'assets/img/pngfind.com-profile-icon-png-1102775.png' %}" class="img-fluid avater" alt="">
								<h4>{{user.fullName}}</h4>
								<span>{{user.accountType}}</span>
							</div>

							<div class="d-navigation">
								<ul>
									<li class="active"><a href="{% url 'profile' %}"><i class="ti-user"></i>My Profile</a>
									</li>
									
									<li><a href="{% url 'logout' %}"><i class="ti-power-off"></i>Log Out</a></li>
								</ul>
							</div>

						</div>
					</div>

				</div>
			</div>

			<form method="POST" class="col-lg-9 col-md-12">
				{% csrf_token %}
				<div class="dashboard-wraper">
					<div class="form-submit">
						<h4>My Profile</h4>
						<form method="post">
							<div style="padding: 20px;" class="submit-section">
								<div class="row">
									<div class="form-group col-md-6">
										<label>Your Name</label>
										<input type="text" name="fullName" class="form-control"
											value="{{user.fullName}}">
										{{form.fullName.errors}}
									</div>
									<div class="form-group col-md-6">
										<label>User Name</label>
										<input type="text" name="username" class="form-control"
											value="{{user.username}}">
										{{form.username.errors}}
									</div>
									<div class="form-group col-md-6">
										<label>Email</label>
										<input type="email" name="email" class="form-control" value="{{user.email}}">
										{{form.email.errors}}
									</div>
									<div class="form-group col-md-6">
										<label>Phone</label>
										<input type="text" name="phone" class="form-control" value="{{user.phone}}">
										{{form.phone.errors}}
									</div>
									<div class="form-group col-lg-12 col-md-12">
										<button  class="btn btn-theme-light-2 rounded" type="submit">Save
											Changes</button>
									</div>
								</div>
							</div>
						</form>
					</div>
					<div style="margin: 40px;"></div>
					<!-- Basic Information -->
					<form method="post">
						{% csrf_token %}
						<div class="form-submit">
							<h4>My Account</h4>
							<div style="padding: 20px;" class="submit-section">
								<div class="row">
									<div class="form-group col-md-6">
										<label>Account Type</label>
										<input type="text" name="accountType" disabled class="form-control"
											value="{{user.accountType}}">
									</div>
									<div class="form-group col-md-6">
										<label>Your Title</label>
										<input type="text" name="yourTitle" class="form-control"
											value="{{user.account.yourTitle}}">
									</div>
									<div class="form-group col-md-6">
										<label>Address</label>
										<input type="text" name="address" class="form-control"
											value="{{user.account.address}}">
									</div>

									<div class="form-group col-md-6">
										<label>City</label>
										<input type="text" name="city" class="form-control"
											value="{{user.account.city}}">
									</div>

									<div class="form-group col-md-6">
										<label>State</label>
										<input type="text" name="state" class="form-control"
											value="{{user.account.state}}">
									</div>

									<div class="form-group col-md-6">
										<label>Zip</label>
										<input type="text" name="zipcode" class="form-control"
											value="{{user.account.zipcode}}">
									</div>

									<div class="form-group col-md-12">
										<label>About</label>
										<textarea name="about" class="form-control">{{user.account.about}}</textarea>
									</div>
								

								</div>
							</div>
							</fom>
						</div>

						<div class="form-submit">
							<h4>Social Accounts</h4>
							<div class="submit-section">
								<div class="row">

									<div class="form-group col-md-6">
										<label>Facebook Link</label>
										<input type="text" name= "facebook" class="form-control" value="{{user.account.facebook}}">
									</div>

									<div class="form-group col-md-6">
										<label>Twitter Link</label>
										<input type="text" name= "twitter" class="form-control" value="{{user.account.twitter}}">
									</div>

									<div class="form-group col-md-6">
										<label>Google Plus Link</label>
										<input type="text" name= "googlePlus" class="form-control" value="{{user.account.googlePlus}}">
									</div>

									<div class="form-group col-md-6">
										<label>LinkedIn Link</label>
										<input type="text" name= "linkedIn" class="form-control" value="{{user.account.linkedIn}}">
									</div>
					<div id="updatereport"></div>
									
									<div class="form-group col-lg-12 col-md-12">
										<a href="#update_profile" id="update_profile" class="btn btn-theme-light-2 rounded" type="submit">Save
											Changes</a>
									</div>									
								</div>
							</div>
						</div>
					</form>

				</div>
			</form>

		</div>
	</div>
</section>
<!-- ============================ User Dashboard End ================================== -->

<!-- ============================ Call To Action End ================================== -->
<script src="{% static 'assets/js/jquery-3.5.1.min.js' %}"></script>
{% if user.is_authenticated %}
<script type="text/javascript">
	function openFilterSearch() {
		document.getElementById("filter_search").style.display = "block";
	}
	function closeFilterSearch() {
		document.getElementById("filter_search").style.display = "none";
	}
	$('#update_profile').click(function (event){
		event.preventDefault()
		
		$.ajax({
			url : '{% url "updateaccount" user.username %}',
			method : 'POST',
			data : {
				yourTitle : $('[name="yourTitle"]').val(),
				address : $('[name="address"]').val(),
				city : $('[name="city"]').val(),
				state : $('[name="state"]').val(),
				zipcode : $('[name="zipcode"]').val(),
				about : $('[name="about"]').val(),
				facebook : $('[name="facebook"]').val(),
				twitter : $('[name="twitter"]').val(),
				googlePlus : $('[name="googlePlus"]').val(),
				linkedIn : $('[name="linkedIn"]').val(),
				csrfmiddlewaretoken : $('[name="csrfmiddlewaretoken"]').val()
			},
			success: function (data){
				if (data.error === undefined){
					$('#updatereport').append('<h6>ypur account has been updated successfully</h6')
				}else{
					$('#updatereport').append('<h6>updated falied</h6')
				}
			},
			error: function(err){
					$('updatereport').append('<h6>updated falied</h6')
			}
		})
	})
</script>
{% endif %}
{% endblock content %}